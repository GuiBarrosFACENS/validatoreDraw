
13:37:22.281[duling-1] ERROR    c.s.m.a.s.w.FileSegmentsWriterService  :  :  : Error creating file at path: (src/main/resources/s3-bucket/arquivo-segmento.txt).
java.io.IOException: No such file or directory
 at java.base/java.io.UnixFileSystem.createFileExclusively(Native Method)
 at java.base/java.io.File.createNewFile(File.java:1043)
 at com.santander.mpa.domain.usecase.impl.CreateFileUseCaseImpl.createFile(CreateFileUseCaseImpl.java:22)
 at com.santander.mpa.app.service.writers.FileSegmentsWriterService.write(FileSegmentsWriterService.java:43)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.writeItems(SimpleChunkProcessor.java:203)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.doWrite(SimpleChunkProcessor.java:170)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.write(SimpleChunkProcessor.java:297)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:227)
 at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:75)
 at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:388)
 at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:312)
 at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
 at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:255)
 at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:82)
 at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:369)
 at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:206)
 at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:140)
 at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:240)
 at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:229)
 at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:153)
 at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:418)
 at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:132)
 at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:317)
 at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:157)
 at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
 at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:148)
 at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:59)
 at com.santander.mpa.infra.config.ScheduleConfiguration.launchJob(ScheduleConfiguration.java:39)
 at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
 at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
13:37:22.288[duling-1] INFO    c.s.m.infra.logger.LoggerChuckListener  :  :  : Error during chunk processing: mergeInvoiceSegmentsLinesStep
13:37:22.290[duling-1] ERROR         o.s.batch.core.step.AbstractStep  :  :  : Encountered an error executing step mergeInvoiceSegmentsLinesStep in job processJob
com.santander.mpa.infra.exception.ErrorWriteFileException: write_file.error
 at com.santander.mpa.app.service.writers.FileSegmentsWriterService.write(FileSegmentsWriterService.java:49)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.writeItems(SimpleChunkProcessor.java:203)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.doWrite(SimpleChunkProcessor.java:170)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.write(SimpleChunkProcessor.java:297)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:227)
 at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:75)
 at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:388)
 at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:312)
 at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
 at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:255)
 at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:82)
 at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:369)
 at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:206)
 at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:140)
 at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:240)
 at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:229)
 at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:153)
 at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:418)
 at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:132)
 at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:317)
 at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:157)
 at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
 at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:148)
 at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:59)
 at com.santander.mpa.infra.config.ScheduleConfiguration.launchJob(ScheduleConfiguration.java:39)
 at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
 at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
 at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
 at java.base/java.lang.reflect.Method.invoke(Method.java:568)
 at org.springframework.scheduling.support.ScheduledMethodRunnable.runInternal(ScheduledMethodRunnable.java:130)
Caused by: java.io.IOException: No such file or directory
 at java.base/java.io.UnixFileSystem.createFileExclusively(Native Method)
 at java.base/java.io.File.createNewFile(File.java:1043)
 at com.santander.mpa.domain.usecase.impl.CreateFileUseCaseImpl.createFile(CreateFileUseCaseImpl.java:22)
 at com.santander.mpa.app.service.writers.FileSegmentsWriterService.write(FileSegmentsWriterService.java:43)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.writeItems(SimpleChunkProcessor.java:203)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.doWrite(SimpleChunkProcessor.java:170)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.write(SimpleChunkProcessor.java:297)
 at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:227)
 at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:75)
 at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:388)
 at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:312)
 at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
 at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:255)
 at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:82)
 at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:369)
 at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:206)
 at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:140)
 at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:240)
 at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:229)
 at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:153)
 at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:418)
 at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:132)
 at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:317)
 at org.springframework.batch.core.launch.support.SimpleJobLauncher$1.run(SimpleJobLauncher.java:157)
 at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:50)
 at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:148)
 at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:59)
 at com.santander.mpa.infra.config.ScheduleConfiguration.launchJob(ScheduleConfiguration.java:39)
 at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
 at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
13:37:22.290[duling-1] INFO   c.s.mpa.infra.logger.LoggerStepListener  :  :  : Step has completed with status: FAILED
13:37:22.295[duling-1] INFO          o.s.batch.core.step.AbstractStep  :  :  : Step: [mergeInvoiceSegmentsLinesStep] executed in 323ms
13:37:22.305[duling-1] INFO       o.s.b.c.l.support.SimpleJobLauncher  :  :  : Job: [SimpleJob: [name=processJob]] completed with the following parameters: [{'runDate':'{value=Wed Jul 31 13:37:21 BRT 2024, type=class java.util.Date, identifying=true}'}] and the following status: [FAILED] in 359ms
13:37:22.305[duling-1] INFO      c.s.m.i.config.ScheduleConfiguration  :  :  : Batch job ends with status as FAILED
