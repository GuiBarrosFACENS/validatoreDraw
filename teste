package com.santander.mpa.app.service.processors;

import com.santander.extractor.utils.ExtractorAdvice;
import com.santander.mpa.domain.usecase.FileSegmentsBuilderUseCase;
import lombok.AllArgsConstructor;
import org.jetbrains.annotations.NotNull;
import org.springframework.batch.item.ItemProcessor;
import org.springframework.stereotype.Service;

@Service
@AllArgsConstructor
public class FileSegmentsProcessorService implements ItemProcessor<String, String> {

  private final FileSegmentsBuilderUseCase fileSegmentsBuilderUseCase;
  private final ExtractorAdvice extractor;

  @Override
  public String process(@NotNull String line) {
    ExtractorAdvice.put("data.data.mapAttributes.process", "process cnab");
    extractor.execute("telemetria_log_category");
    return this.fileSegmentsBuilderUseCase.processLine(line);
  } 
}
