package com.santander.mpa.domain.usecase.impl;

import com.santander.mpa.app.processor.PlardDatabaseControlProcessorImpl;
import com.santander.mpa.domain.entity.PlardMetadata;
import com.santander.mpa.domain.usecase.ProcessReturnUserCase;
import com.santander.mpa.infra.dto.PlardMetadataDTO;
import com.santander.mpa.infra.mapper.impl.PlardMetadaMapperImpl;

public class ProcessReturnUserCaseImpl implements ProcessReturnUserCase {

    private PlardDatabaseControlProcessorImpl plardDatabaseControlProcessorImpl;

    public ProcessReturnUserCaseImpl(PlardDatabaseControlProcessorImpl plardDatabaseControlProcessorImpl) {
        this.plardDatabaseControlProcessorImpl = plardDatabaseControlProcessorImpl;
    }

    @Override
    public void processReturnDataPlard(PlardMetadataDTO plardMetadataDTO) {
        PlardMetadaMapperImpl plardMetadaMapper = new PlardMetadaMapperImpl();
        String plardMetadataStatus = plardMetadataDTO.getStatus();

        if (plardMetadataStatus.equals("REPROVED")) {
            plardMetadataDTO.setStatus("CLOSED");
            plardMetadataDTO.setResolution("REPROVED");
            plardMetadataDTO.setReason("<MOTIVO A DEFINIR>");
        }

        if (plardMetadataStatus.equals("APROVED")) {
            plardMetadataDTO.setStatus("CLOSED");
            plardMetadataDTO.setResolution("EXECUTED");
            plardMetadataDTO.setResolution("EXECUTED");
        }

        plardDatabaseControlProcessorImpl.saveInDatabase(plardMetadataDTO);
    }
}
